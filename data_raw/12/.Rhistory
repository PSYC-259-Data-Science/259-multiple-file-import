library(randomForest)
library(randomForestExplainer)
library(dplyr)
library(caret)
library(reprtree)
library(readr)
ds <- read_csv("classification.txt")
ds$time <- as.numeric(row.names(ds))
library(tidyverse)
ds %>% group_by(class) %>% summarise(n = ())
ds %>% group_by(class) %>% summarise(n = n())
ds$classe <- ds$class
ds = subset(ds, select = -c(1,2,3) )
ds$classe <- factor(ds$classe,levels = c(1,5,6,7,9,10),labels = c("upright", "held_walk","held_stat","sit_surf","sit_rest"))
ds$classe <- factor(ds$classe,levels = c(1,5,6,7,9),labels = c("upright", "held_walk","held_stat","sit_surf","sit_rest"))
intrain <- createDataPartition(y = ds$classe, p = .65, list = FALSE)
training <- ds[intrain,]
testing <- ds[-intrain,]
rfmodel <- randomForest(classe ~ ., data = training, localImp = TRUE, proximity = TRUE,na.action=na.roughfix, ntree = 50)
predictions <- predict(rfmodel, testing, type = "class")
confusionMatrix(table(predictions, testing$classe))
